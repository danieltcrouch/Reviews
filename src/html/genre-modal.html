<link rel="stylesheet" type="text/css" href="https://religionandstory.com/common/css/modal.css"/>

<div id="genreModal" class="modal-wrapper">
    <div class="modal-foreground">
        <div class="modal-box">
            <div class="modal-header">
                <span id="modalHeader" class="subtitle">Ten Top 10</span>
                <span id="close" class="close">&times;</span>
            </div>
            <div id="modalBody" class="modal-body center">Choose a Top 10 list:</div>
            <div id="modalSubmit" class="modal-submit center">
                <div id="genreCol1" class="col-3r center"></div>
                <div id="genreCol2" class="col-3r center"></div>
                <div id="genreCol3" class="col-3r center"></div>
            </div>
        </div>
    </div>
    <div class="modal-background"></div>
</div>

<script>
    var callback;
    var loadData;

    function openGenreModal( genreNames, genreCallback, getGenreData )
    {
        var modal = $('#genreModal');

        createButtons( genreNames );

        modal.show();
        setCloseHandlers( modal );
        blurBackground();

        callback = genreCallback;
        loadData = getGenreData;
    }

    function createButtons( genres )
    {
        $('#genreCol1').empty();
        $('#genreCol2').empty();
        $('#genreCol3').empty();

        for ( var i = 0; i < genres.length; i++ )
        {
            var index = (i%3) + 1;
            index = ( i === genres.length - 1 ) ? ( (index === 3) ? index : index + 1 ) : index;
            var genre = genres[i];
            $('#genreCol' + index).append( "<button id=\"" + genre.id + "Button\" class=\"button\" style=\"width: 10em\" onclick=\"openGenreModalCallback('" + genre.id + "')\">" + genre.title + "</button>" );
        }
    }

    function openGenreModalCallback(answer )
    {
        closeModal( $('#genreModal') );
        if ( loadData )
        {
            // $.post(
            //     "php/reviews.php",
            //     { action: "get" + answer + "List" },
            //     function( response ) {
            //         callback( answer, JSON.parse( response ) );
            //     }
            // );
        }
        else
        {
            callback( answer );
        }
    }
</script>